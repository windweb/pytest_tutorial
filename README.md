# Pytest Tutorial Repository

Этот репозиторий содержит материалы и примеры, созданные в ходе изучения курса "Pytest Tutorial – How to Test Python
Code" на [YouTube](https://www.youtube.com/watch?v=cHYq1MRoyI0). В ходе этого курса рассматриваются базовые вопросы о
том, как использовать pytest для
тестирования Python-кода, а также даются советы по использованию ChatGPT для ускорения процесса написания тестов.

## Содержание

- [x] Введение / Introduction
- [x] Наши первые тесты / Our First Tests
- [x] Тестирование классов / Class-based Tests
- [x] Фикстуры / Fixtures
- [ ] Маркировки и параметризация / Mark & Parametrize
- [ ] Мокирование / Mocking
- [ ] Тестирование с использованием ChatGPT / Testing with ChatGPT

## Введение / Introduction

В этом разделе представлены основные сведения о курсе и его целях.

- **Что такое Pytest?** **Pytest** - это мощный и гибкий фреймворк для написания простых и сложных тестов на Python.
  Он
  позволяет легко создавать и запускать тесты, предоставляя множество функций для улучшения процесса тестирования.

    - Фреймворк для тестирования на Python
    - **Автоматическое обнаружение тестов**. Pytest может автоматически находить тесты в вашем коде. Он ищет файлы и
      функции, имена которых начинаются с `test_`, и выполняет их как тесты. Например, если у вас есть файл
      `test_example.py` с функцией `test_function()`, pytest автоматически обнаружит и запустит эту функцию как
      тест.
    - **Богатая интроспекция утверждений**. Pytest предоставляет подробные сообщения об ошибках для утверждений без
      необходимости использования специальных синтаксических конструкций. Например, если утверждение `assert a == b`
      терпит неудачу, pytest покажет значения переменных `a` и `b`, что помогает быстрее понять причину сбоя.
    - **Поддержка параметризованного тестирования**: Pytest позволяет легко создавать параметризованные тесты, где
      одна и та же тестовая функция запускается несколько раз с разными параметрами. Это делается с помощью
      декоратора `@pytest.mark.parametrize`. Например:
        ```python
      import pytest

      @pytest.mark.parametrize("input,expected", [(1, 2), (3, 4)])
      def test_increment(input, expected):
          assert input + 1 == expected
      ```
    - **Тестирование на основе приспособлений (fixtures)**: Fixtures в pytest - это мощный инструмент для настройки
      и
      очистки кода перед и после тестов. Они могут быть использованы для создания объектов, необходимых для
      тестирования, и для выполнения необходимых действий по очистке. Например:
        ```python
        import pytest

                  
        @pytest.fixture
        # В этом примере sample_data является фикстурой, 
        # которая предоставляется тестовой функции test_sum в качестве аргумента.
        def sample_data():
            return [1, 2, 3, 4, 5]
      
      
        def test_sum(sample_data):
            assert sum(sample_data) == 15
        ```
- **Почему именно Pytest?**
    - **Упрощенный синтаксис:** Pytest позволяет писать тестовые случаи как функции, а не как методы в классах, что
      упрощает код и делает его более читаемым. Нет необходимости наследоваться от классов, как в unittest.
    - **Богатая интроспекция утверждений**: Pytest предоставляет подробные сообщения об ошибках для утверждений.
      Если утверждение не выполняется, pytest покажет вам точные значения, которые привели к сбою, что значительно
      упрощает отладку.
    - **Мощная система приспособлений (fixtures)**: Fixtures в pytest позволяют легко настраивать начальные условия
      для тестов, такие как подключение к базе данных или создание тестовых данных. Это делает тесты более
      модульными и повторно используемыми.
    - **Совместимость**: Pytest хорошо работает с другими библиотеками Python и поддерживает интеграцию с множеством
      популярных инструментов разработки.
    - **Расширяемость**: Pytest может быть расширен с помощью плагинов, что позволяет добавлять новые функции и
      интегрировать сторонние инструменты, улучшая тем самым процесс тестирования.

## Наши первые тесты / Our First Tests

В [tests](tests) вы найдете материалы и примеры, связанные с созданием первых тестов.

## Тестирование классов / Class-based Tests

Этот раздел посвящен тестированию классов в Python с использованием pytest.

## Фикстуры / Fixtures

Фикстуры - важная часть тестирования с pytest. Здесь вы найдете информацию о том, как использовать их в ваших тестах.

- Фикстуры в pytest — это функции, которые запускаются перед (а иногда и после) выполнением тестов.
  Они используются для настройки тестового окружения, например, для создания тестовых данных,
  инициализации базы данных, открытия сетевых соединений и т.д.
  Фикстуры помогают избежать дублирования кода и делают тесты более читаемыми и легкими для поддержки.

  Пример использования фикстуры в pytest:
  ```python
  # content of test_example.md
        
  import pytest
        
        
  # Определение фикстуры
  @pytest.fixture
  def sample_fixture():
      return "Hello, World!"
        
        
  # Использование фикстуры в тесте
  def test_greeting(sample_fixture):
      assert sample_fixture == "Hello, World!"
  ```
  В этом примере `sample_fixture` является фикстурой, которая возвращает строку "Hello, World!". Эта фикстура
  затем
  используется в функции `test_greeting`, которая проверяет, что значение, возвращаемое фикстурой, соответствует
  ожидаемому.

- Фикстуры в Pytest обладают рядом **особенностей**, которые делают их мощным инструментом для настройки
  тестового
  окружения и управления им:

  **Область видимости (Scope)**: Фикстуры могут иметь различную область видимости, такую
  как `function`, `class`, `module`,
  `package` или `session`, что определяет, как часто фикстура будет вызываться — для каждого теста, класса,
  модуля,
  пакета или сессии тестирования соответственно.

    - **Автоматическое использование (Autouse)**: Фикстуры могут быть настроены так, чтобы они автоматически
      использовались в тестах, без необходимости явного указания их в параметрах тестовой функции.
    - **Параметризация (Parametrization)**: Фикстуры могут быть параметризованы, что позволяет запускать один и
      тот
      же тест с различными наборами данных.
    - **Финализация (Finalization)**: С помощью встроенного механизма `yield` или декоратора `pytest.fixture` с
      параметром `teardown` можно добавить код, который будет выполнен после завершения теста, например, для
      очистки ресурсов.
    - **Кэширование результатов**: Фикстуры с областью видимости, отличной от `function`, могут кэшировать свои
      результаты и переиспользовать их в разных тестах, что ускоряет выполнение тестов.
    - **Вложенность фикстур**: Фикстуры могут использовать другие фикстуры, что позволяет создавать сложные
      зависимости и настройки тестового окружения.
    - **Использование фикстур во множестве тестов**: Фикстуры могут быть определены в одном месте и
      использоваться в
      различных тестовых модулях, что облегчает переиспользование кода.
    - **Модификация фикстур с помощью плагинов**: Существует возможность изменять или расширять поведение
      фикстур с
      помощью плагинов Pytest.

  Пример фикстуры с использованием некоторых из этих особенностей:

    ```python
    import pytest
      
      
    # Фикстура с областью видимости "module" и автоматическим использованием
    @pytest.fixture(scope="module", autouse=True)
    def setup_and_teardown():
        # Настройка перед тестами в модуле
        print("Setting up")
        yield
        # Очистка после тестов в модуле
        print("Tearing down")
      
      
    # Тест, который автоматически использует фикстуру setup_and_teardown
    def test_example():
        assert True
    ```
  В этом примере фикстура `setup_and_teardown` будет автоматически применена ко всем тестам в модуле,
  и её код будет выполнен один раз перед началом тестов и после их завершения.

## Маркировки и параметризация / Mark & Parametrize

Узнайте, как маркировать тесты и использовать параметризацию для более гибкого тестирования.

- **Маркировки (Marks)**

  Маркировки позволяют классифицировать тесты по определенным критериям. С их помощью можно легко включать или
  исключать
  группы тестов при запуске. Это полезно, например, когда некоторые тесты должны выполняться только в определенной
  среде
  или когда вы хотите временно исключить часть тестов из запуска.

  Пример использования маркировки:

    ```python
    import pytest
  
  
    @pytest.mark.slow
    def test_example_slow():
        pass  # Тест, который будет маркирован как медленный
  
  
    @pytest.mark.fast
    def test_example_fast():
        pass  # Тест, который будет маркирован как быстрый
    ```

  Запуск тестов с определенной маркировкой:

    ```bash
    pytest -v -m fast
    ```

  Эта команда запустит только тесты, помеченные как **`fast`**.

- **Параметризация (Parametrize)**

  Параметризация позволяет запускать один и тот же тестовый метод с разными наборами данных. Это упрощает написание
  тестов для функций, которые должны работать с различными входными данными, и помогает избежать дублирования кода
  тестов.

  Пример использования параметризации:

    ```python
    import pytest
    
    
    @pytest.mark.parametrize("input,expected", [
      (1, 2),
      (3, 4),
      (5, 6)
    ])
    def test_increment(input, expected):
      assert input + 1 == expected
    
    ```
  В этом примере тест `test_increment` будет выполнен три раза с разными парами значений `input` и `expected`.

Объединение маркировок и параметризации также возможно, что делает систему управления тестами в Pytest особенно гибкой
и
мощной.
Например, можно параметризовать набор тестов и одновременно применить к ним определенную маркировку для дальнейшего
контроля их выполнения.

Использование маркировок и параметризации в Pytest позволяет создавать более чистый, понятный и гибкий код тестов,
а также упрощает управление процессом тестирования.

## Мокирование / Mocking

Мокирование позволяет заменить реальные объекты фиктивными для упрощения тестирования. В этом разделе рассматривается
использование мокирования с pytest.

## Тестирование с использованием ChatGPT / Testing with ChatGPT

Узнайте, как можно использовать ChatGPT для более быстрого написания тестов и автоматической генерации тестовых данных.

